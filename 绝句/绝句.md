# 绝句程序设计语言

- 语言层次：常量(literal)、言元(atom expression)、言(expression)、句(statement)、段(block)、构(item)、书(file)
- 面向对象构件：常(const val)、变(var)、量(val) 取者(getter) 置者(setter)、事(fun)、造于(constructor) 初(init)、例(object)、物(class) 伴生例(companion object)、类(interface)
特化物：扩物、内物(inner class)、储物(data class)、例物(enum class)、况物(sealed class)、标物(annotation class)、抽象物(abstract class)
- 预定义引用：亲(super)、我(this)、你、它
- 预定义常量：真、假、空
- 类型系统：函数重载、子类型多态、参数化多态、入/出 生产消费型变性声明、交集上界限制、可空性、『我属』预定义类型变量
- 语言特性：面向对象编程、构件可见性、函数及属性扩展、闭包、多态、操作符重载、Annotation

## 修饰符

### 通用

- 可见性：公开、族内、私下、内部
- 开放性：开放、终定、覆写
- 外部定义：待例、实际
- 标记：【(类型) {(名=)? (常量/常量组)}、】

### 特化

- 函数及属性修饰：抽象、实现、内联、记法 「(记法)」
- 函数修饰：算符、尾递归、断续
- 参数修饰：许多、跨嵌、不嵌
- 变参修饰：晚成
- 类型参数修饰：实化、入、出
- 类型修饰：取置、断续

修饰以 `{修饰符}、 的 (构)` 形式应用到语言构件。

### 定义
#### 引用列表
- 包(复合名)为
- 引(复合名) [的(名)].[成(名)]
- 引全(复合名) [的].[除(名或行)]
### 其他形式例子
- 常(类型).(名)=(常量)
- 属别名(名)=(类型)
- 对何<(类型形参)> [其中 {(类型参数)：(类型)}、] 皆有
- 事 (名)"(" (形参) ")" 为 …其中块
- 事 (名)"(" (形参) ")" = (言) …其中块
### 其他形式例子 引用项
- 其中块
  其中，{局部定义}
- 局部定义
  (量/变参/事)
- 顶部定义
  (局部定义/常参/例/物/类)
- 文件
  Shell行? 包? {引记法}? {引入}? {文件标记}? {属别名}? {顶部定义}?

注意这里那个 (类型) 啊不是说这个在解析器里就检查，这里 (类型) 全都视为 (复合名)。

### 代理(delegations)

+ 物中的属性可以 `代者……` 指定值代理。
+ 物本身同样也指定实现代理

### 基本控制流
#### 变量
- 量(名)[：(类型)]=(言)
- 量 提(模式)=(言)
- 变(类型).(名) [初(言)]
- 变参(名)[：(类型)] [初(言)]
#### 判断
- 若(你?) (言)…… [ 否则…… ] （第二人称）
- 判断，{ (言或行)…… } [ 否则…… ]
- 判(你?) (言)，{ (言或行)…… } [ 否则…… ] （第二人称）
- 判(你?) (言)属，{ 于(类型或行)…… } [ 否则…… ] （第二人称）
- 判(你?) (言)存，{ 于(言或行)…… } [ 否则…… ] （第二人称）
#### 重复
- 对(言)里的(名)……
- 对(言)里的 提(模式)……
- 对(言)里的 你…… （第二人称）
- 对(言)里的…… （第三人称）
- 重复 若(言)……
- 重复…… 若(言)。
#### 返回
- 回(标签?) (言?)
- 回 交(言)
- 回 重写(参数列表)
#### 跳转
- 停下(标签?)
- 略过(标签?)
#### 结构化异常
- 尝试…… { 接迎(类型)…… } [ 终焉…… ] （第三人称）
- 抛下(言)

### 中缀链
- 「它 (记法及的链)」 （第三人称）

例：「它的名字+1」、「它前」

记法包括中缀记法如「以」和后缀记法如「~上面」「~为零」

中及后缀记法有 __否定修饰__，如「是」前跟“不”构成「不是」、「为零」前跟“不”构成「不为零」

`「」` 形式可以在需要闭包的地方被提供。
### 可空性
- (~)? //空访问
- (~)! //非空断言
- (~)空则(言)
- (~)空则……

`空则(言)` 版本的「空则」不接受 `断止` 值。

### 访问语法
- (~)的(名)
- (~)去(名)(参数列表)
- (~)去::(名)
- (~)"["(言)"]"
- (~)(参数列表)
- ::(名)

参数列表可以具名，对应地，形式化参数也可包含可选参数。

函数式引用 `::` 可以把面向对象 receiver 视作第一个参数，如 `数.(数)数` 可以视作 `(数、数)数` 来用。

### 前缀
- 非(~)
- -(~) //取负
- +(~) //取正
- *(~) //扩铺(spread)
### 连接词
- 且 //(&&)
- 或 //(`||`)
- 是 //(==) 试等
- 即是 //(===)
- 存于 //(in) 试含
- .. //(..) 取至
- (~)属于(类型) //(is)
- (~)作(类型) //(as)
- (~)作?(类型) //(as?)
### 数学计算
- `+` //加
- `-`  //减
- `*` //乘
- `/` //除

## 记法（自定义中及后缀）
- 引记法(复合名) 「(记法)」
- 引记法(复合名).除 「(记法)」
- 定记法 「(记法)」

记法可以包含任何名字本身可以包含的部分，以及符号、数学符号区段的字符。

带 `'~'` 前缀的记法是后缀记法。

## 逻辑连接简记法

你(言) {(且/或) 记法链} （第二人称）

## 缩进和文法布局

类似「事」「例」「物」「类」的定义构件，都是使用「为」来限定起止部分的。

绝句里「，」及「为」开启新布局，小于后随布局空格数的缩进结束这个布局。

绝句里有可以换行的语法形式：
-  缩进要求比当前布局宽：参数切分「、」和「。」
-  缩进要求持平当前布局：「；」

> 实现注记：递归下降法扫描指定缩进切分的多个项目时，多层嵌套可能在一处下降缩进，同时收尾。此时除了利用 mark/reset 保证不会消耗那些缩进空格外，也可以通过抛出 exception 实现单次确认多层嵌套的缩进布局解析。

## 逗号表示法

逗号表示法可以用于「若」「判断」这样结构「段」的表达，也可以用于创建闭包。

逗号表示法有两种形式，逗号布局、逗顿句简写。

```
“逗号布局”
若此人的名字是"林则徐"，
  说("苟利国家生死以")
```

```
“逗顿句简写”
若此人的名字是"林则徐"，说("民族大义")、说("苟利国家生死以")。
```

如果用于闭包则还有一种指定闭包参数的扩充。

```
人们 映为，〖他〗他的名字。
人们 映为，〖他〗
  他的名字
 ```

+ 逗顿句简写内不能包含逗号表示法。
+ 逗号闭包里的「回」必须带标签。
+ 逗顿句简写的值是最后一个单句的值；逗号闭包的值由「回」指定

## 标签
- 「事」及逗号闭包的接收者会引入隐式标签
- 「对」「重复」和逗号闭包的逗号后可以加 `[]` 引入标签
- `[^]` 标签仅用于有值需求的逗号块，进行返回值指定

## 针对 Nothing 的处理

- `Nothing` 在绝句里被称为『断止』
- 「回」「抛下」「停下」「略过」都是“言”，它们的值都是『断止』
- 断止不能作为参数或初始量
- 断止在「空则」里只被逗号表示法形式接受
- 断止作为函数返回值，类型必须显式写出
- 『我属』(Self) 和『断止』(Nothing) 都不能被「属别名」别名

> 注：即便不能直接作为初始量，`量n=若p，回。否则，1。` 这样的代码是可以被接受的，因为他们的并集(union) `数+断止` 是 `数`，不是 `断止`。
<br>顺便说一句，交集(intersection) 是以 `A&B` 形式表示的。

## 常量

- 真假 Boolean
- 数 Int、长数 Long
  - 符号 (+/-)?、后缀 (L/l)?
  - 支持 0x 0b 表示法
  - 支持汉字数
- 短浮 Float、浮 Double
  - 支持 (+/-)? (E/e)? exponents
  - 后缀 (F/f)?
- 字 Char
- 文 String
  - 支持 `\"\'\t\b\n\r\$\\` escape
  - 支持 `\uXXXX` Unicode escape
  - 支持 `$(名)` 和 `${(言)}` 嵌入
  - 支持 `""" """` 跨行文本
- 名(标识符)
  - Unicode 字符类 L(M/O/T/U)、NL
  - 换 Kotlin 的强行合法化 \`\` 成 『』
  - 所有仅以 `'_'` 构成的名字均不可用

### 其他语法成分
- 注释
  - 支持可嵌套 `“”` 全角双引号，`‘’` 不可用
- 半角 `,` `.` `;` 不可用
- `" \t\f"` 都是空格、`"\n\r"` 都是换行

## 保留构词

模板、类实例、性质推导

## 一些非语法细节

- Any 值
- Exception 错误；Error 失败
- Unit 效果
- get 取；set 置
- getValue 取值；setValue 置值
- component1 取分一
- mod 取余
- invoke 用以
- zip 与；to 到
- upTo 至；until 止；step 步长
- isEmpty 记法「为空」；contains 试存
- toString 化文；asIterable 作迭
- inc 前；dec 后
- startsWith 以()始

绝句的顶类型并非『值』，而是『分配』。分配只少一个 `成文()：文`。

绝句的关键字(keywords) 被称为『构词』，构词分为三种。
- 软构词：能够作为名字使用
- 常构词：不能作为白名（非角括名字）
- 苛构词：不能作为白名的起始部分

常见命名空间
- kotlin 被分成了 `绝句` 和 `绝句.额联`
- kotlin.ranges `绝句.区间`
- kotlin.collection `绝句.集合`
- kotlin.text `绝句.文本`
- kotlin.annotation `绝句.标记`
