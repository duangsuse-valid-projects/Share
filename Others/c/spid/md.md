# 得罪了谁，我的视频都黑了？

Hi我是动苏，又到了大家最喜欢的环节，今天挂两个人。

其实不是，作为一个三个月前励志要讲Java入门，但最后写了个JS贪吃蛇直接停更搞技术的编程区up，和一些对技术不走心，也不是同一个编程方向的人锤来锤去，还不如多复习几个项目

但是老子乐意

和上期消气视频一样，我准备了表情包站和图形动画的源码，以及一个脚本语言的实现放最后 证明我的确有这个程度，而不是吃不到葡萄酸一些『阿里啊腾讯的员工』；不过我想，我七上八下的更新频率就是最好的佐证，发现新东西就会忘记时间

拿代码怼人，的确有点夸张，但随便删我小科普文、__说我自以为是，我今天就让你们看看我是怎么回事！__

## 缘由

两个月前呢我看到了标题「一天写编译器」的视频，当时我就觉得明显是UC震惊体、标题党啊（可为啥子要挑我的领域下手啊），点进去看发现这人引用了我之前看过，点了赞的一期C++做的树IR+GC语言的视频(除了录屏较差 分篇还好)，排除标准API它像JS的子集 (一上来C++树虚拟机 做算式求值流控 1天你认真的？

然后又举了网易上几十小时的课程——你搜搜B站这类吃灰视频动辄十几小时的也没少啊，然后说结合这俩，相信 __一天内也不难写出，啊没有那么成熟的编译器吧。__

原来我憧憬了四年的技术，难度只是因为太成熟的东西功能太多啊，__启舰杂谈__，那你倒是把语言功能举出来，说说哪些删了 能少写多少行代码，令毫无基础的资深web「前端」工程师能一天弄出来啊！ 

你以为只是选路径的难度，所以有现在流行的那什么路线图，哦你都选好做法了，“逐个击破”一定轻而易举吧，你都不屑动键盘，过时的东西了。

你知道代码在C语言编译期有几种中间格式吗？知道main之前发生了啥吗？ 就那么 __简单一提，随口定论，哦原来我们学了个寂寞__

原来健身博主腹肌是打药的、你努把力7天能速成的、程序员高薪是乱象、有少年班的不能自报家门，反正只要和自己没关系，都是猎奇，都是装B，对吗？

计算机和电子不是玄学，失之毫厘谬以千里，差1字符的语义，一个1的区间偏差就是正常和错误；你不要看字少，许多时候为一两行的代码能试几个小时 最后发现第1小时的代码是对的，你不笨偶尔也会糊涂；要是想不出来，一字千金可真不假

好家伙，原来编译器前端和web 前端，叫前端的都是一个难度，__只是有些捷径有些窍门你不知道罢了！？__

当时听语文课上老师告诉我们，袁隆平比一些流量明星更值得被珍惜； 到B站以后我看到了，也明白了原理级技术人可以多甘于卑微、乐于分享，也明白了为什么一些学霸对旁人提足底气，因为出了社会，他们就会背后遭某些人敌视了。 可不指望身边的人理解咱，只能尽量自尊。

院士袁隆平和他的团队在田里不管烈日寒冬实验了15年，才使得第一版杂交稻推广； 某大厂工程师在镜头前从零开始嫌弃太长太虚 研究了1天，就写出一个「简版」编译器？惊不惊喜？

## 价值

关于技术的价值，有一个故事广为流传。 福特汽车厂有台电机停了，谁都修不好，于是请那时最负盛名的机械师调试。

这人只四处看了下，在本子上算了算，然后拿扳手在某处敲了一下；收费30万

厂子不干啊，你凭啥狮子大开口啊，处变不惊列出收据：敲，0.5刀；在哪敲，30万

好好看看你书架上那些技术书籍明码标价多少，都是版权费。 不要问为啥贵，你看它带来了什么、技术给人带来了什么，双向选择。 __口口声声热爱，最后全是实用主义，而且是傲慢的实用主义。 你不要可以闭嘴，要的大有人在。__

知识有何价值。TCP拆黏包一些人可能听说过，如果你知道包是TCP网络层而非字节流传输层的概念，别瞎听新闻，别手动chunked，这余下来的时间和算力做点啥不好？
啊你修好了很牛啊，你做了你不该负责的事，有用吗？

编译难吗？的确有简单的做法，抽象掉输出和指令格式、大量利用JS既有的值体系，用嵌套括号表达式，极简分词与解析，我们只实现一个运算栈和if跳转,支持函数体参数再压个行，它其实只要30行

```js
evalOrd=s=>{
    let now,eat=()=>{now=s.next().value},a=[/*code*/],add=v=>a.push(v),
    par=i=>{//chk () +-ops myVar "val"
        "()".indexOf(t)==i; if(i==1)eat();
        if(i==2&&now[0]!=1)err();
    },
    x=()=>{// -x | (Expr) |word
      if('@'+now in unOp){x(); add(now)}
      if(par(0)&&eat()){ elay(); par(1)}
      else add(now)&&eat()//匹配才吃
    },
    o,elay=ed=>{//lev=> x (op>lev expr(op))*
        x();for(o=par(2);l[o]>l[ed];){elay(o)} add(ed)//等价逆波兰双栈。没o==ed是为保留作比较 len0|>?push:close&push(now)
        //;x(ox)* if(t[o]==lev){ push(ed,x());ed=o;o=x()}
        //1-2+3 首层=; 故-本应最后, 替换先出前项
    },
    fbody=(sco,out)=>{//(f 1 2) (\name x1 x2. body) ;x+1 (? q a b) (= newVar v)
        while(eat()){
            if(!par(0)) {(now==';')?elay(opc.expr):add(now)&&eat(); continue}
            now[0]=='\\'; fbody(putInc(till('.'),new Map(sco)),aa=[]);add(aa) //sco._ncall+=1; sco[k].i+=1; sco+=arg; all vref=[call,argidx]=[i,j]
            now=='?'
            now=='=' //sco._nlvar+=1; get=loc[narg+i]; upval=filter i!=0
            par(1)
        }
    }
    fbody(global,a); return a
}
vmExec=(a,ip=0,evalstk=[1,1,'$+'/*编号化+-避免名字解析?*/],callvar=[[arg,lvar,upv=[[1,0],]] ],glodict={k:v})=>{}
// f(x1,x2)= x1 x2 f:1 ap =push call(sco["f"],st.splice(st.len-2,2)) ;; brz iptr= if(pop()==0)ip+=
```

>哈？排版不好？多情况的算法思想用稀疏的代码只会更难读，那你是真不知道为啥只OI有压行一说； 隔行如隔山，批判请谨慎

这只是骨架，完整版120行，如果你说的是树walker那可能40行还够。解释下前面这个分词遍历同时负责函数作用域、执行序的深者先，每对 `(fn a b (? c))` 调用都是abc 1?先添加再 3 fn ，VM执行 `f(st.slice(n-3,))` ；后面的四则执行序你可能觉得简单，你试试。 而且你搜『编译器』，他们首先会上等价的深先AST和私货的四则解析，初见美但往往不合适， 不说语法的执行先从分词开始教，不说意义先从写法开始教，你用脑想想这些坑是不是随便找家教程就能避。

```js
tok=s=>s.trimLeft().split(/([-+*/])\s*/g), strm=(a,_s=a.values())=>()=>_s.next().value,
exp=(s,l)=>{
  let o,x=()=>add(Number(s())), ord=[],add=x=>ord.push(x),
  one=ed=>{let a,b
      x();for(o=s();(a=l[o])>=(b=l[ed]);)if(a==b){add(ed);x();ed=o;o=s()} else one(o);  add(ed)
  }
  one(";");return ord
},
vexp=cod=>{let st=[],x;cod.pop(); for(x of cod)(typeof x=='number')?st.push(x): (i=> st.splice(i,2, opr(x,...st.slice(i)) ))(st.length-2); if(st.length!=1)throw st; return st[0]},
opr=(k,a,b)=>eval(a+k+b),
splitD=(s,sp0,...sp)=>sp0?s.split(sp0).map(x=>splitD(x,...sp)):s,
optab={[';']:-1}; splitD("=;+ -;* /",';',' ').forEach((k,i)=>{for(let _ of k)optab[_]=i})
{
  document.write("<input id=x> <b id=y>")
  x.onchange=(ev,a=exp(strm(tok(x.value)),optab))=> y.textContent=a.join(" ")+vexp(a)
}
```

这是一个计算器，欸你说你写个URL绑定数据库访问最少也20行吧，那这20行和你20行能一样么，我加了俩私货，你替换成流行写法试试耗多久，这是计算器，你说编译器。 差别说大不大，你试试。

不要谈helloworld，拿字面常量调个子程序，启动汇编版都只要4条命令。 对熟悉一门语言来说，连基本值/类型和语句块 判断/重复、函数定义都不知道，弹个窗删建个文件，只能说脚本得开心就好喽（turtle

`gcc -xc -masm=intel - <<<'main(){asm("mov rdi,%0;mov rsi,1; call printf":: "a"("Hello,wor%dd\n"));}'`

x64 CDEF拿固定寄存器传参，x86参数字节调用方负责分配清理，啊作为用户你当然不需要了解.so符号表、代码对应啥机器码，不需知道虚拟机、CPU+内存片的差异，学过加减判断就明白代码即数据吗， 你现在提到这个伏地魔的名字，你有啥觉悟？

别拿工程量当『难度』，别拿战术勤奋掩盖战略懒惰， 别把能死背冗杂难懂书当实力；真正的技术，只为目的复杂。__眼里没有目的，就和只懂算计的机械一样__

__我一行行代码看似简单啊__，只是这背后的苦心和提纲、沉淀，方法论，是三年里兴奋起来熬的夜，这一切的时间和精力厚重的成本，你受的起吗？连简介里贴个链接都这么困难

你知道我的一手资料有多难吗？这些英文paper和人家第1遍能用的码有多杂，你怕不是没看过吧？

好看吗？拿痘印换的。

LH的教程好学他能1天“肝”吗，你试试，再跟我说要几天。 64K-intro 的程序不过是我视频稿2倍体积，努力一把，你3天能得奖。 有些代码不是肝，要脑子。

你以为是世人皆醉 就我会想，其实只是它太深了，就像你站在百米高楼，已经失去危险感了，不是它复古了或者你能了，原来现在狂妄自大都这么理直气壮的么

我对一手资料发起了多少次实践挑战，从中总结经验枚举精炼，才懂了各种层面与选择的做法，开开心心把它写成文，而一个看热闹的人自以为懂了，冷不丁，原来你就这回事、你牛逼我一句听不懂， 就你懂啊。你说我火不火。

他还在评论区抱怨什么，良作无人啊。我整体态度和看标题时一样，是质疑的，因为这个人通篇贴了几个链接(甚至http:或BV号也没给)，没有一行代码，他是怎么从三分钟的吃灰清单得到“只用一天”的结论的？如果啊如他所说，华为不找他真是可惜了呢；然而人家在阿里，可也是个大IT 唉你们在干什么啊

过几个小时一看，__很奇怪，他给删了__。他可能不知道我手打这么多字花了半个小时 没有备份，也不理解我为啥要对阿里专家无私的精品分享“冷言相向”，更无所谓这背后两三年的见闻积累和动手实践，以及我受国内PLT圈某些大佬傲气，也要探索自己感兴趣事物，并将它传播开来的决心

技术都是提供好给你的，难度你自然看不见；钱都是爹妈攒的，你当然不辛苦；你以为看40分钟视频就万事大吉就会改了？呵呵，知道啥是基础吗，基础是透明是空气是黑箱，没空气，你说这大话的机会都没得

我思量这纯粹技术交流也不会是系统误删吧

普通的就像破石头落到井里，甚至如果我不去看，还不知道这两个展开下能写成博文的小提纲，从通篇废话的视频下消失了。如果不是我发现剪贴板有，就真没了 （他可能以为我在装B

好吧，我发了一句话，大意是你要学会尊重相应方向的人、删了我也会写更好的，转发动态，后来也被删了，可能也拉黑了。有粉丝劝我 __不要跟这现实过不去，我就当没看过__。

## 流量密码

但是前几天我又看到了熟悉的标题党，说高斯模糊啊、我的世界像素图能修复回一模一样，就像他的封面糊字全还原，7w播放，我还以为是 那种 waifu2x,javplayer 基于CV学习的工具呢，看评论区才知道果然又是个AI开源项目Depix加震惊体，真是属于脚不沾地、乱讲一通了

您知道降采样是啥么，您知道 1+2=3, 3=1+2=2+1=0+3=... 这些基本直觉吗？Depix是您写的，还是您跟作者很熟？ LH的视频不火，需要您再加个网易课帮他宣传？

你抱怨没人，我也想问呢！可是我明白了，无人问津的有趣技术太多了，大家都有自己的兴趣、__有需要极快解决的小问题，这些原理分享无所谓成为主流；但我们至少该 互相尊重__

您这流量密码握的死死的，拿别人的东西夸大宣传，__这不就是做营销号吗。__

您吃其他集体或个人的流量，对这些人保持尊重，不拿这种破事问作者、不莫名删贴拉黑，是最基本的礼仪吧？

你们不会以为在 __登月阿波罗周年开源纪念上刷“到此一游”__，并且直接导致GitHub推出了 issue spam 系列功能，是有荣誉感的程序员做的事情吧？

人家不懂汉语，但知道 是『中国』的程序员做的。 膜拜大佬要保持距离和尊重啊； 我想问这些人一句，你们是真在关心人，还是把他人当你自满的工具？

## 您不配

如果你用真正意义传统的分词/解析器，甚至用YaCC，C语言实现同等功能，300行起步，按 LLVM Cookbook 上的码风实现函数与调用就70行，不要以为对不抓重点的、只管功能的人300行很长啊

__没错你听不懂，所以我是有意装逼『知乎大佬』__，所以有那种捷径up是1天速成的，有20行代码贪吃蛇up，你去找他问问，他带你 你愿不愿意带自己。

那代码不是越长越NB吗？现在算绩效都不是按行号算啊大哥。 你们的眼中除了代码文本，有没有看到更概括更大的东西？

你去知乎看看PLT和CE到底是啥行吗，您写过不带break的查找吗，对哪个也别对基础领域满嘴跑火车啊，是欺负我们不上B站？ 

我不说看不着的执行环境和嵌套的解析，+-*/算符链我给你细讲了你彻底弄懂可能要一天。 一些人 a ,b,c 切分列表的 split join 都没手写过哪来的资格说一天干完，

呵，看着只3行代码啊，你复制粘贴下载摘抄能耗几秒啊，脚本精灵也能啊，您有脚本精灵快吗？您一天能写编译器，两天能做脚本精灵吗？ 不能啊，因为你真的想过咋写脚本精灵但搜不到啊

__打3行字，免费。知道字背后的结构如何运作，您不配。__ 理解我和我们是怎么通过上十次重写化繁为简到3行，大家都有权，您，不配。

您最聪明了，干啥事一天都能完成，不像我，我写了三个月、一年、两年，到现在，八门语言推倒重来9遍，这是一个项目。我太蠢，不太懂您的这些书单和所谓的简化技巧。 因为我就是下到最黑的泥潭里，只要取出的东西在我看来是闪耀的，在所不辞，“我们”也一样；“聪明”的人干啥都不秃头，“愚钝”的人才会把小一天的事当实事去做

__欲造根基，必承其重；不先入门张口就来，小一天，您牛逼__

在某些人眼中我们就是给人拎包、给好戏做铺垫的是么。 __永远能把别人的变自己的，自己的变祖传的__，唉。

## 泥地

您不会以为您做过点应用就懂编程语言了吧，天哪，原来我经历的简化重写、结构等效、程序数据化与流前缀，不是脱胎换骨，是某些人学完时兴的Java开发就懂的啊。

```kt
sealed class Num {
  data class Op(val id:Char,val a:Op,val b:Op):Num()
  data class Lit(val n:Int):Num()
  val v:Int get()=if(x is Lit)x.n else when(x.id) {//v=eval
    '+'->x.a.v+x.b.v; '*'->x.a.v*x.b.v
  }
}
```

您试试拿它计算 `1+2*3` ，再算 `"1+2*3"` 比较下难度。用后序栈更简单，自己搜；搜完做个参数值引用，自己搜动态作用域，这才是基础级入门，还是我选的。你搜百度看看哪有资料

别人告诉你和你懂是两码事；狭义和广义的编程是两码事；Java和Javac是两码事，不是啥都能触类旁通啊，它不止是超集啊

什么？你说你搜不到，要听现成的？4行的算法都嫌费时间，我告诉您了 `d.copy().update({'a':2})` 您也不懂

那插入、冒泡排序核心也就1行啊，copy版快排和合并排序也才3行(二分先;与两子先,再合并) 啊，bitswap和atoi 也1行，默写可以，您来给我解释下都是为啥

算符(+前,后缀)切分的单项 序读取是解析器必要点，目前我会算符重排栈、递归深先、下落根重写三种算法，也了解LR左递归优化那一套。 万里长征第0步，懂了你算会写编译器吗？你连编译前端都不算，前端的输出是按类型处理完命名引用和跳转地址回填的中间表示，知道啥是闭包和词法域吗？没有闭包住上级量，许多人和框架的 onclick 都不会工作， 知道2维数组ij咋转化成指针吗，N维呢？什么，你用不到？

接刚才的 以深项先+栈传参、替代AST树不可暂停及带名字地利用栈， `(\ a b. )` 内是文件级没值语句的列表，其值是生成到单独[]的代码块，靠 `(ret 1)` 向上层写入单返回值，没错，返回值只是个栈地址，参数是暴露的局部量，你看过反汇编吗，C语言的调用就是这样。我们每次的工作就是这样，简单~你试试。

而 `(\name x.)= (= name (\ x.) )`、`(f (? q a b) c)= q br.not :b a br :c b c 2:f` ，我没写多余的，test指令 `qe=0,&ae;ae=-1,iptr` ，一个if都这么难，和 `(= var (\` 一样特殊处理 记末位置再回填。你用 `(q?fa:fb)()` 编译两块代码区分就简单了，可惜性能低

我已经从解析器本质、求值=语法树重写+变量替换 走出这么远，`;inc=((\ a. (\ b.a+b) ) 1) ;inc 2` 的行为还是不正确，因为它没闭包^。

>LC 这本书四则优先级实现有问题，但一遍输出树结构写对很难，可以用我上面Lua的算法或逆波兰算符重排； `1+2*3^4`  它是逐两符比较优先级，加乘 2被乘法抢到了，
>但 `1+(2*3)^4` 的乘结果,乘方，3已经被括住了，优先级高也没用了；Lua算法是递归深先遍历，它做得到也支持同符右先，但输出是后序栈
>Lua算法是不能暂停的逆波兰，波兰双栈支持括号也是每'('副本整个栈的，本质相同于Lua递归

## 免费的是最贵的

Babel,Kotlin,TypeScript;Webpack,Proguard ，我加个清华学历留学科班flag可以像王某人一样收6k教你什么科学基础，我免费了，你嫌便宜，觉得挣不到钱； 我告诉你为啥编译器不卖钱，要是当程序员有成本，哪来那么多免费又好用的软件？计算机是为挣钱赚眼球而生的么？好好想想，第一台计算机是为科学计算而生； 我们的领域不值钱、世界上第一个网站不要注册客户端弹窗通知，__因为是它托起你们挣钱的梦想__，视而不见，你们就拿百年不变的烂代码去骗最终用户去吧

工程界一些人，真的该好好反思下自己的头衔 engineer ，我们听到『工程』都觉得很美很值得，改进创新是该做的，复制是避免的。 你觉得你学习，上大学读研为了什么？为了实事，实事求是待人、实事求是做事，就是这样。

但很多人上大学为读研、读研为工作挣钱扎根北上广，励志吗？还好，但‘好’这个字从来不在他们的目标里，只在个人里。

>迷信『智商』真的很不好欸，很多人因此固步自封、或妄自菲薄，你们被骗了。 没有值比它自己(id)更能代表这个值，你可以看文件md5，可以看位置，可以求什么商积啊，但这些都是极短的摘要，1 可以=2-1,3-2 ，整数也能以二进制、链表实现，但它最好的表达就是字面十进制； 对你最了解的理应是你本人。每做一件事前都去检验啊某种指标配不配，写个函数检查数值宽窄对不对，__社会摘要你，但摘要自己真的会遮盖许多亮点与可能。__

互相尊重。我们是做事的，不是打架的。打架别扯本职工作外的内容。 什么友商友商的，什么人之常情，就是虚伪。何必呢？

回去看了下他的标题竟然还是反问句，我tm… 是的是的都对，但您，没有发这个视频资格，没有在您其他视频下拉它流量的资格，更没有随意删技术评论拉黑人的资格。__您评论区随您，我倒要看看B站和B友随不随您__

__请您立刻删除那期视频。LH的视频和网易课有心学的人搜不到？需要你“搬运”？__

编程语言是配角，某位程序员是配角，但你要说他们廉价，看我不喷死你

一天搞懂，那你培训一年是不是就能当Native编译器前后端资深研发工程师， 进入那个华为拿百万年薪了啊；我告诉你，你想得美。

想当知识暴发户，你做梦就好。 两个小贩互买零食1块钱就能交换完彼此库存，钱和资源价值上可动的手脚太多了，技术怕吃苦，那你慢慢等开窍吧。

## 从无到有>从有到好

我们这个领域消掉信息差，告诉你读输入是字符流、递归下降法也能当分词、树遍历，把成员访问调用变量变成值，处理条件性求值，乃至函参何时求值和嵌套作用域，与参数靠栈上位去传 四则本质是函数 等事实 ，不要害怕、过度强调二进制格式和cmd参数,元编程,std API这些无关的；那还是解释器

我告诉你函数是值、能作参数，回调函数只是调用方不在自己代码内 调用了，没有本质不同，告诉你闭包和对象区别只在有无类型名，举例子教(iterStop,asyncTask,event注册)，你真接受可能都要一天

__不会吧不会吧，不会真有人把没见过当不存在吧。__ 不会还在用百度吧，用Bing啊

因为很多人并不是会「编程」，而是会按他从网上、从老师那看到实例的模式，去改了代码拼在一起，出错了猜着重试；他不知道 __什么不是必须的、什么可以换、什么是为了背后的什么__，因为他看到的只是眼下的『代码文本』 “printf语法” “cout<<语法” 运行出啥效果，关心的没有示例数据与环境，和成百上千的使用设备里成百上千次执行。 并不是说我们得害怕不可控性，而是得尽量写好，写得优雅易懂易维护。

栈是啥，存变量的地方嘛。 字符串是0结尾ASCII码表数组，除了这些呢，还知道什么？还能怎么用。__什么应该简化，什么可以再看细节__，性能上什么优缺点； 现在这不基础，但不基本吗。

就是一个人不落入 yacc/peg, token[]与tokVal, substr +-*/, LR左递归;难判断语法树,冗长命名,过早优化 等全部拉扯和坑比较多的做法，他从0做一个高级计算器也要两天，要是网学就要一周，因为本领域废话水平可不低。

您吹牛逼是直接捡最硬核的蹭了，您口中的简化编译器的源语言，该是C语言的子集吧，因为您对编译器一词根本莫得概念。先看看自己地址空间的指针和size_t,long转int[]学会、gdb条件断点用过了没！ 你要是再支持DCE,CSE等 等效优化，bfs dijkstra 算法都不会写，可没人帮你想啊。

看过 _The Little Schemer_ ，它不提文本解析器和let赋值 就三 单项、调用括号的求值重写、参数-subst ，和 yinwang.org 博客一样，我第一次看都完全看不懂，现在我觉得是最优雅最灵魂的教程，你试试。 __极简不是对现有体系的否定，它只是做它更看重的精力配比__。要是你拿它当捷径、当无知的道理，我告诉你，__三脚猫的心走哪条路都是三脚猫__，也就开始让能你飘几秒，人易我易 没球用。 Kotlin泛型推导也容易，你设计下试试。

你可能不知道初学者会为层叠 `Map<K,V>` K遮盖恢复的实现举出 `scope=old.copy+vars; List<M>, M<K,List<V>> , M<Int,V> ,M+Stack<M>` 或对或错的实现，是因为我们傻吗？呵，是因为我们在追逐真知，

__为了追求干的傻事，不可笑；战士为不辱使命伤残，是荣誉。__

至于我自己的心得，我不会在视频里说。这次和大家分享已经是特例，真的是对某杂谈这种投机取巧营销号非常无语。

那有句话，你要跟火箭发动机工程师说火箭不能烧汽油，得用最好的那种柴油，他正眼看你一眼算他输。 不错，我输了，但正是因为我只重视我所热爱的事，才不计较这些形式。凭什么原理就得硬核？只要你想学理应人人都能懂！__你呢。你删我科普评论的时候，重视的是什么呢。自相矛盾。__

__从1到2 是1，从0到1 无限大__，不要小看这个1 ，它不是你轻轻松松在百度 搜个一两天能明白的。做事要奇，做人要正。踏踏实实。 开闭口革命更新，打破这个颠覆那个，请问您在哪里培训了几天，有何实践经验？ Talk is cheap, show me code.

## 第二个人

本来我说 __程序员鱼皮__ 虽然不了解情况，但待人还算客气

好吧，虽然他上来啥都不看，先入为主觉得我是吹牛、自我陶醉。 __中国人自谦是为了自警，不是为让无关人啊指指点点__

是不是因为我用户名没标「程序员」右下也没小闪电就觉得我菜。那 Linus@kernel.org 也没有啊，是B站都没呢，也没微信QQ啊，靠发电子邮件工作。 他名字不含程序员，为啥大家都知道他是程序员呢？

你以为事无巨细平铺穷举就叫易读，一五一十原汁原味就叫易懂， 阿Q正传一句批判没有，为啥说是讽刺呢； 我80%的篇幅都无关你俩，但依然是在敲你俩。来源情况很多，目标都是成果

当时安慰自己，他也就是编程玩玩呗，拍视频有娱乐价值，不爱看给删了，必须接受；我不对玩笑过敏

不回头看不知道，呵，遮掩几天，他居然也给我拉黑了 mo? 我说过你不爱听我再不评论也做到了啊，需要您拉黑吗，多大仇啊？

您的视频我可都是点赞投币过的啊，__跟你风抱怨几句你自己还看不惯了__，银电视up就是这么宠粉的，结合我之前第一次被撕的经历，真是让我不敢和BAT大厂的天骄们交流了。

那我是说了什么耸人听闻的事情呢，和这个什么一样，在我初中就开始用的 Linux 做了个小总结，这有啥了不起这是爱好啊？ 也有个小建议，这算是友善行为吧？后来给我禁言了。

并不是菜就没有做事的理由，而是 __菜而不自信，让别人心烦。__ 位置是相对的，运动是绝对的。 今天你轻蔑嘲笑的人，可能一年后莫名其妙就超过了你；也有无数人，甚至天资已经在你前面；比烂，没有丝毫意义，难道我们的追求的是新知识，死盯的却是抱着同样求知欲的人，羡慕的眼神吗？

真的好好笑欸，比你强的人看不见，专对比你弱的人装硬。好好的交流搅得跟宫斗一样，才写两行代码就比别人尊贵了，您把写码当修真动漫 动不动进化天尊呢。 中国某些公司的程序员，啊真的素质普遍垃圾

每个人都可以好好挣钱，啊说什么资深 深入 精通，懂的都懂，真真假假。但包装自己 恰饭不尊重自己恰的人群 ，删评论，你还知道自己在做不光彩的事怕人说啊，那你别做啊。

>尊重。尊重对方的领域、尊重对方的爱好、尊重对方的用心，尊重自己有不了解的领域的事实，也尊重自己领域内不同的人。

现在越来越多的人会对底层原理感兴趣，虽然相关的视频质量七七八八，但为探寻真知敢于触碰这些别人说很难的东西，这种勇气是值得嘉奖的，只要，唉你尊重相关的群体，不要拿他们的心血当空气。 玩笑可以开，删评拉黑你可悠着点，别以为学的不流行人都好欺负。

不会真的有人不复制编程…… 不好意思，我就是。 因为娱乐性就可以随便删？试试看大家接不接受。

不会因为社会的尊重、社区的友好，要出国的人就回来；但哪怕多留一人，对中国而言都是种新的可能，对领域而言都是位新的底气；__强大不是靠嘴说出来的，强大是靠人合起来的__。就像数学和基础物理，我们可以不用，但不能没有

不自信，那他们就没有自尊吗？

__有自尊，但在自尊的同时也自卑着。__

## 为何自卑

因为自卑，所以看不得别人好；因为自卑，所以害怕正视自己的菜；但有个问题啊，我是在炫富拉仇恨吗？难道我们这类人就没有平等交流的资格了吗？

如果没有，__你们也没有发现更多渠道、更多社区的资格__，社区里的人只是因为意愿而交流分享，有party也有吵吵闹闹，大家只是因为相同的爱好聚首，没有金钱利益你高我低和流量，只有每个个体基于他见闻的看法和建议；发自真心，归于真心

人跟人隔座山，但正是因为讨厌这些我才会关注你，__不是你不配，而是爱好 根本没有配不配！__

自由对待知识，本来是所有人的权利，你可以不要，但无权劣化环境

科学就是科学，不要拿一些庸俗的眼光和度量衡对他人妄加判断。

收你各种手续费传你1/10的人你抱得像宝，向你敞开一切过去主动来帮的人你说自以为是，我就是太贱

今天的我很贵，我4段代码开源，但你们贴不起谢谢 你敦促了我，与你无关；我收的不是钱和谬赞，是你们的同理心，欸怎么在某人的做法里我连撇点钩都没看到

__择趣求知是我对技术的信仰，平等待人是我对交流的信仰__。我从不把一些人最爱计较的你高我低带入代码的世界，我不无故复制，一切本着科学的精神，看度量指标说话；用事实说话

在技术的世界里，我比人弱，也比某些人强；我每句话前都有检讨自己有没有傲慢、有没有自卑，但对那些拿技术当把戏耍的人，我可管不住自己的大嘴

人有两只眼睛，一只前瞻一只顾后；一只用来看见，一只用来欣赏。遮住一只会怎么样。

我看到过几十个比我厉害的人，或许10年之后我也赶不上他们的脚步，但我发自内心地尊重和欣赏他们，能和他们平等对话，也看得见和他们比，自己独有的闪光点

我弱，但我不自卑；我说大话，但都是事实；我不聪明，初高中倒数第一，但不因此全盘否定自己，因为我知道，__不是聪明的人一定赢，而是失去自我的人 赢也输__；我不励志，我只做眼下的事

我骄傲不是为自己成绩差，不是为我特立独行，而是为完整认识了自己。 你呢

你可以伪装外国的技术是自己原创拿来怎样，但他强，他就在那。 他可以不说话，但压迫感就在那，不管你怎么泼脏水、骂是技术霸凌、装B、垄断

事实不会因为你的情绪有任何挪动，拜托，__你有权菜，只是不要那么敌视平等交流__，毁了你自以为的大厂另辟蹊径flag，我不求你什么人格尊重、和平相处，至少尊重我码的字、尊重我对科普的热爱，好吗？

我只是玩玩，我无所谓，你那么认真干嘛

。。那我也只是玩玩，你别和我争，开开心心好过一天就行了

## 大道之行

之前，我说许多原理级技术人甘于卑微、乐于分享；他们为啥要这样呢

或许只是因为乐于分享，才有这样的他们吧。无关自豪或流行,毕竟，教学半。

只有一切既得的东西都满足不了你，才会有觉悟去寻找属于自己的方法，追寻更多可能吧

只有一切虚浮的表象都不让你安心，才会离开安全区，向远方进发

或许在有人看来你已相当富有，但诱惑着你的并不是某一刻的远方，只是远方而已

因为已经满了的人，在自认最高的那一刻，趋势就为0了；就像熟透的果实，满了，该走向衰败了

毕竟运动是绝对的，静止只是相对主观的 ；如果你是真想知道更多，从「我最聪明」里跳出来吧

自尊很重要，但只有为技术抛弃盲目自信，才能真正收获自尊。

在无数次奔跑过后，你不再关心 旁人眼中晨曦里的远方 会是什么颜色，只是不断地，把它变成近在咫尺的真实

别卡死在一个目标上。 Don't block! Keep moving

## 功利主义

急功近利从商人角度看没问题，1分投入1分回报 不接受“偷懒”，它是策略但它带来的短视是致命的。我们说磨刀不误砍柴工，功利主义者看不到磨刀的价值，甚至想省去应有的开销。

如果你不懂开销付出为啥有个最小值，就会走上一些复制粘贴搜藏，去走所谓的窍门捷径，这相当于你伪装在做这件事，对涉及的领域只有索取很少付出。

并不是功利不能成功。但成功也会对大环境有不良影响，而且最终你的失败可能和成功一样快；就像红芯、红星浏览器、木兰，那忽悠人真的脸皮不红的。

不同领域对功利容忍度不同。我们也是板凳坐得十年冷，哪怕冷下去，也讨厌一些流行技术娱乐不动真心凑我们的热闹。

我觉得大家对这些可以武断一点，咱们宁缺毋滥；但凡功利皆可抵制，因为真技术人员是不会有任何夸大宣传的

## 另外

LH_Mouse 的视频我没投币但点赞了，他是C++纯手写(递归下降法)实现js语法子集的 标准 lex(str->token[]),parse(->AST),compile(->VM-TreeIR),无OOP,最后用语言虚拟机执行，40分钟gdb讲解标准的PLT大作业，注意用了许多C++术语cow,refmove啊，为啥比火魂侠、楚国刮大风火， 一方面是他的录屏虽然无字幕但较精炼，另外他的封面和标题很吸引小白

语言特性是var,for(each解构 和 a[i++] a[$] 的push指针 以及GC,递归/noreturn/REPL ，语法还可以，但源码和到处do_,xop_,XXassert 的码风实在不适合小白；冗长和故藏玄虚 可以说是本领域的通病，仅通过调试断点而不考虑代码优雅性，有点不够，没有把本领域爱走大极端的根性去除：

解析就是带查错的结构读取、编译就是优转化+代码生成到树或线形指令，排除二进制,作用域和GC 和普通Python,Ruby元编程没有本质不同，跳转和tailrec尽量早转化。为支持break,cont在单层vm_eval()里解释我觉得不合适，那Lua tailcall:ABC 和 call 是一个格式，等于充填跳回当前函数头 C恒0不支持多返回，非常优雅

LH 的子程序(函数)实现看了半天我不太懂，因为我没见过IR主要在优化没扁平的编译，但JS里是这么做： 

```js
tco=f=>(...a0)=>{let now=a0,frec=(...a)=>{now=a},a,r; for(;a=now;now=null,r=f(frec,...a)); return r}
tco((f,n)=>n==0?0:console.log(n)||f(n-1))(3)
```

不要说我刻意写短，尾递归就是重写参数再来遍；ES6标准入门里阮老师用数组push写了10行他也是这个思路

C++模板魔法师的头衔 技术圈都知道啊，__如果不讨厌这些，那就找不到更清晰易懂的方法__ 为啥Linux不是C++写的呢。

证明自己明白最好的手段不是我牛逼，而是，我也能让别人明白。

你要明白一个事实，同类软件很多，重复代码很多，代码量和一些所谓的规范性，影响不到我们要的性能和目的。如果你放不下旧代码，可以彻底重写

视频的parse那一篇，只有一个弹幕“啥都比较简单”，简单吗？是的，启键你不从0做当然简单。实例背后的原理，简单吗？

## 注

流行的 gcc,clang 编译器都将C,C++,Go,.. 分词再匹配变成AST语法树，再统一化为IR中间表示

- clang: .c->LLVM IR->DAG图:SSA寄存器分配->MC->.S  (see rust/crystal-lang)
- GCC: .c->GccAST->GIMPLE->RTL->.S

C 文件(CompileUnit)顶级是接口声明/定义，一般声明放 .h `#pragma once` 代表整个项目.c 拼合后只出现一次，不因多.h引用而重复声明，.h .c 的区分是方便他人使用接口以及无顺序的定义实现，理论上 gcc 是单独处理每个.c 文件，所以定义冲突是链接器才会报错

catch-landingpad 等特性和C符号导出/链接的多语言支持的确该有中间形式

main() 在 POSIX ELF 可执行上由 __libc_start_main 启动，argv和env的传递由OS-ABI决定，一般是sp栈寄存器指向区域。总之，除非 gcc -static ，ld.so 和libc在你的C程序前载入


## 项目-表情包

Tag: SpringBoot+MybatisPlus,cookie,siglepage-JS, Kotlin ，0后端基础

表情包是指 包名.zip 内多张 图名.png ；密码登录用户可发布/删除表情包

表情包和用户都有名字与注释，二字段都可搜索

```kotlin
open class O(val name:String,val desc:String) // CRD, U:desc
data class User: O()
data class Pak: O(val id:Int)
```

身份验证可选 Header Token/JWT 或服务端 Session-Cookie ，JWT签名效率对API可能略高且跨服跨域

举例，?token= 是手动分配 cookie，而 APP-TOKEN 这类官方客户端验证像 JWT

选其二， `resp.addCookie(Cookie("uid", "Jack").apply{maxAge=60*60*24;path="/"}); req.cookies`

SB 可用 `@CookieValue("key")` 绑参数，但我们仅用它做验证，应添加中间件 `POST /; DELETE /id` 验证用户有效、 `pak.uid==cuUser[cuki]`，否则 401 Unauth

`PUT|DELETE /u/id` 同理

>SQL基础
```sql
Create O=Insert INTO T values()
Read O=Select*FROM T where name or desc like "%str%"  limit pageN offset idxPage
Update O=Update T SET k=v where id=
Delete FROM T where id=
```

真是醉了，SQL已经够冗了，MyBatis XML 还凑什么热闹，还弄了不起的Plus Codegen解决呦。我可真想 Hibernate

但是 J2EE 魔法师一来，就没你 SQL 什么事了，直接另起炉灶，还起不完全

> 然后这个 .zip 通过 post `form[enctype=multipart/form-data]` 上传后

3年前JSP是 commons/fileupload 解析 post body 实现，在 spring 里 reqParam MultipartFile 和 req.getFiles 都可传文件，不需md5校验切分patch啥，此不查重。

文件需要 `unzip&python -c 'import PIL,sys; print(each splitext[0]argv) w=max(im);h=sum(im); for m: y+=m.h'`  这样解包、生成精灵图，方便客户端预览。

我们可以用 Java util.zip/awt 完成并利用 ForkJoinPool 并发加速，或者用 util.conc_.BlockingQueue 延时计算`Scheduled(fixedDelay = 5000)`，但对表情包上传意义不大。文件结构创建完是 `包名.zip 包id.png 包id.txt`，分别是用户上传、纵拼合大图、每项 "图名( 高度)?\n" 由JS显示。 如果是多图文可不用雪碧图，但多小图预览必须合并下载。

```java
@Service{ //顺， MapperScan("pkg") 等于包下所有class是 @Mapper 的，与 @SBApp 同时使用需com.xx.mapper子包名，同名冲突
@Autowired TaskExecutor;
fun onPush(File) {
    f.transerTo(File("/tmp/"))
    taskExecutor.execute { Runtime.runtime.execute("cd;unzip {fp}&&python -c '' *") }
}
}
@Configuration/*for Bean objs*/{
@Bean fun()=ThreadPoolTaskExecutor().apply{
    corePoolSize=maxPoolSize=4; threadNamePrefix="spiritr"; initialize()
}
}

@Component class My:Runnable{
fun run()=LoggerFactory.getLogger().info("called from spiritr")
}//@wired applicationContext.getBean<My>()
```

(配置创建的 ThreadPool).execute(组件应用 Runnable) ；不管是你还是框架需弄啥操作 `@Autowire Type obj;` 请求后直接用 obj 就行，依赖注入

MVC(J界xml精) 是指 html模板-model生成view ，控制器指 URL router 。还不如叫 Router-Sql-Template 呢，可惜这次我们RESTful JSON微服务

咱别重视 Java 依赖配置那一套。  首先是 @RestController (返回不是视图,是数据) 里 `@GetMapping("/url")` (Req_Mapping meth=GET)，有 @ request,path,body-param 参数绑定，也有 `@ConfigurationProperties @ConstructorBind` 啊，语法和 @CookieValue 一样，我们在实现里操作相应 Mapper(指向SQL) 实现功能

注意 pom 的依赖名版本号得对，build/xml 里的路径名字得对应， not found 可能要加 `SqlSessionFactoryBean.mapperLocations+= classpath:/info/mappings/**/*.xml` ，或者搜 "yml 通用"

嘛，设计和现实有出入。理论上 pak,user 作为 class O 至少可以PUT更新，但 Mybatis 是做SQL绑定而非ORM对象管理，适合业务常更新的情况，改字段要写大量语句，它只有 `@Update("update id=#{id}")` 这种很长的没有 `Repo{fun findAllByOrderByAddedAtDesc()}` 简短且CRUD的，概念是 SQL session+mapper 而不是 entity+persist/flush manager

你不制造问题，就没多破事。 这些都是ORM框架可实现的：

数据 A:B=1:N ，故 `a.bs= select*from B where owner=a`、 `a.add(b)= insert into B values(owner=a)`

至少，实现 make/drop:pak,user list&filt:pak,pakOfU,u


